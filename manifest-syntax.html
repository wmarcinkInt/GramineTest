<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Manifest syntax &mdash; Gramine  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/gramine.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Attestation and Secret Provisioning" href="attestation.html" />
    <link rel="prev" title="Configure Gramine" href="configuration-index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/gramine_logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Start Here</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Installation-index.html">Select a Deployment Option</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Ready-Made Application</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="curated-installation.html">Ready-made Confidential compute images</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Protect Your Container</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gsc-installation.html">Gramine Shielded Containers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Custom Build Gramine</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="custom-installation.html">Quick Install or Custom Build Gramine</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="configuration-index.html">Configure Gramine</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Manifest syntax</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#common-syntax">Common syntax</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#log-level">Log level</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loader-entrypoint">Loader entrypoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="#libos-entrypoint">LibOS Entrypoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="#command-line-arguments">Command-line arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#environment-variables">Environment variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#user-id-and-group-id">User ID and Group ID</a></li>
<li class="toctree-l4"><a class="reference internal" href="#disabling-aslr">Disabling ASLR</a></li>
<li class="toctree-l4"><a class="reference internal" href="#check-invalid-pointers">Check invalid pointers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gramine-internal-metadata-size">Gramine internal metadata size</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stack-size">Stack size</a></li>
<li class="toctree-l4"><a class="reference internal" href="#program-break-brk-size">Program break (brk) size</a></li>
<li class="toctree-l4"><a class="reference internal" href="#allowing-eventfd">Allowing eventfd</a></li>
<li class="toctree-l4"><a class="reference internal" href="#external-sigterm-injection">External SIGTERM injection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#root-fs-mount-point">Root FS mount point</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fs-mount-points">FS mount points</a></li>
<li class="toctree-l4"><a class="reference internal" href="#start-current-working-directory">Start (current working) directory</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sgx-syntax">SGX syntax</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#debug-production-enclave">Debug/production enclave</a></li>
<li class="toctree-l4"><a class="reference internal" href="#enclave-size">Enclave size</a></li>
<li class="toctree-l4"><a class="reference internal" href="#non-pie-binaries">Non-PIE binaries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#number-of-threads">Number of threads</a></li>
<li class="toctree-l4"><a class="reference internal" href="#number-of-rpc-threads-exitless-feature">Number of RPC threads (Exitless feature)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#optional-cpu-features-avx-avx512-mpx-pkru-amx">Optional CPU features (AVX, AVX512, MPX, PKRU, AMX)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#isv-product-id-and-svn">ISV Product ID and SVN</a></li>
<li class="toctree-l4"><a class="reference internal" href="#attribute-masks-for-sgx-sealing-key-derivation">Attribute masks for SGX sealing key derivation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#allowed-files">Allowed files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trusted-files">Trusted files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#encrypted-files">Encrypted files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#file-check-policy">File check policy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#attestation-and-quotes">Attestation and quotes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pre-heating-enclave">Pre-heating enclave</a></li>
<li class="toctree-l4"><a class="reference internal" href="#enabling-per-thread-and-process-wide-sgx-stats">Enabling per-thread and process-wide SGX stats</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sgx-profiling">SGX profiling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sgx-profiling-with-intel-vtune-profiler">SGX profiling with Intel VTune Profiler</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#deprecated-options">Deprecated options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fs-mount-points-deprecated-syntax">FS mount points (deprecated syntax)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#experimental-sysfs-topology-support">Experimental sysfs topology support</a></li>
<li class="toctree-l4"><a class="reference internal" href="#protected-files-deprecated-syntax">Protected files (deprecated syntax)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#attestation-and-quotes-deprecated-syntax">Attestation and quotes (deprecated syntax)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="attestation.html">Attestation and Secret Provisioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance.html">Performance tuning and analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="manpages/index.html">Manual pages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="developer-index.html">Developer Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials-index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts-index.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor-index.html">Contribution Guidelines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resource</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="management-team.html">Management Team</a></li>
<li class="toctree-l1"><a class="reference internal" href="gramine-users.html">Users of Gramine</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Gramine</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="configuration-index.html">Configure Gramine</a></li>
      <li class="breadcrumb-item active">Manifest syntax</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/manifest-syntax.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">


           <div itemprop="articleBody">
             
  <section id="manifest-syntax">
<h1>Manifest syntax<a class="headerlink" href="#manifest-syntax" title="Permalink to this headline"></a></h1>
<p>A manifest file is an application-specific configuration text file that
specifies the environment and resources for running an application inside
Gramine. A manifest file contains key-value pairs (as well as more
complicated table and array objects) in the TOML syntax. For the details of the
TOML syntax, see <a class="reference external" href="https://toml.io">the official documentation</a>.</p>
<p>A typical string entry looks like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[Key][.Key][.Key] = &quot;[Value]&quot;
</pre></div>
</div>
<p>A typical integer entry looks similar to the above but without double quotes:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[Key][.Key][.Key] = [Value]
</pre></div>
</div>
<p>Comments can be inlined in a manifest by starting them with a hash sign
(<code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">comment...</span></code>).</p>
<p>There is also a preprocessor available: <a class="reference internal" href="manpages/gramine-manifest.html#gramine-manifest"><span class="std std-ref">gramine-manifest</span></a>, which renders manifests from Jinja templates.</p>
<section id="common-syntax">
<h2>Common syntax<a class="headerlink" href="#common-syntax" title="Permalink to this headline"></a></h2>
<section id="log-level">
<h3>Log level<a class="headerlink" href="#log-level" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>loader.log_level = &quot;[none|error|warning|debug|trace|all]&quot;
(Default: &quot;error&quot;)

loader.log_file = &quot;[PATH]&quot;
</pre></div>
</div>
<p>This configures Gramine’s debug log. The <code class="docutils literal notranslate"><span class="pre">log_level</span></code> option specifies what
messages to enable (e.g. <code class="docutils literal notranslate"><span class="pre">loader.log_level</span> <span class="pre">=</span> <span class="pre">&quot;debug&quot;</span></code> will enable all messages
of type <code class="docutils literal notranslate"><span class="pre">error</span></code>, <code class="docutils literal notranslate"><span class="pre">warning</span></code> and <code class="docutils literal notranslate"><span class="pre">debug</span></code>). By default, the messages are printed
to the standard error. If <code class="docutils literal notranslate"><span class="pre">log_file</span></code> is specified, the messages will be
appended to that file.</p>
<p>Gramine outputs log messages of the following types:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">error</span></code>: A serious error preventing Gramine from operating properly (for
example, error initializing one of the components).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warning</span></code>: A non-fatal issue. Might mean that application is requesting
something unsupported or poorly emulated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">debug</span></code>: Detailed information about Gramine’s operation and internals.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trace</span></code>: More detailed information, such as all system calls requested by
the application. Might contain a lot of noise.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">error</span></code> log level is suitable for production. Other levels may leak
sensitive data.</p>
</div>
</section>
<section id="loader-entrypoint">
<h3>Loader entrypoint<a class="headerlink" href="#loader-entrypoint" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>loader.entrypoint = &quot;[URI]&quot;
</pre></div>
</div>
<p>This specifies the LibOS component that Gramine will load and run before loading
the first executable of the user application. Currently, there is only one LibOS
implementation: <code class="docutils literal notranslate"><span class="pre">libsysdb.so</span></code>.</p>
<p>Note that the loader (the PAL binary) loads the LibOS binary specified in
<code class="docutils literal notranslate"><span class="pre">loader.entrypoint</span></code> and passes control to this binary. Next, the LibOS binary
loads the actual executable (the user application) specified in
<code class="docutils literal notranslate"><span class="pre">libos.entrypoint</span></code>. Also note that, in contrast to <code class="docutils literal notranslate"><span class="pre">libos.entrypoint</span></code>, the
<code class="docutils literal notranslate"><span class="pre">loader.entrypoint</span></code> option specifies a PAL URI (with the <code class="docutils literal notranslate"><span class="pre">file:</span></code> prefix).</p>
</section>
<section id="libos-entrypoint">
<h3>LibOS Entrypoint<a class="headerlink" href="#libos-entrypoint" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>libos.entrypoint = &quot;[PATH]&quot;
</pre></div>
</div>
<p>This specifies the first executable of the user application which is to be
started when spawning a Gramine instance from this manifest file. Needs to be a
path inside Gramine pointing to a mounted file. Relative paths will be
interpreted as starting from the current working directory (i.e. from <code class="docutils literal notranslate"><span class="pre">/</span></code> by
default, or <code class="docutils literal notranslate"><span class="pre">fs.start_dir</span></code> if specified).</p>
<p>The recommended usage is to provide an absolute path, and mount the executable
at that path. For example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>libos.entrypoint = &quot;/usr/bin/python3.8&quot;

fs.mounts = [
  { path = &quot;/usr/bin/python3.8&quot;, uri = &quot;file:/usr/bin/python3.8&quot; },
  # Or, if using a binary from your local directory:
  # { path = &quot;/usr/bin/python3.8&quot;, uri = &quot;file:python3.8&quot; },
]
</pre></div>
</div>
</section>
<section id="command-line-arguments">
<h3>Command-line arguments<a class="headerlink" href="#command-line-arguments" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>loader.insecure__use_cmdline_argv = true
</pre></div>
</div>
<p>or</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>loader.argv = [&quot;arg0&quot;, &quot;arg1&quot;, &quot;arg2&quot;, ...]
</pre></div>
</div>
<p>or</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>loader.argv_src_file = &quot;file:file_with_serialized_argv&quot;
</pre></div>
</div>
<p>If you want your application to use commandline arguments you need to either set
<code class="docutils literal notranslate"><span class="pre">loader.insecure__use_cmdline_argv</span></code> (insecure in almost all cases), put them
into <code class="docutils literal notranslate"><span class="pre">loader.argv</span></code> array or point <code class="docutils literal notranslate"><span class="pre">loader.argv_src_file</span></code> to a file
containing output of <a class="reference internal" href="manpages/gramine-argv-serializer.html#gramine-argv-serializer"><span class="std std-ref">gramine-argv-serializer</span></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">loader.argv_src_file</span></code> is intended to point to either a trusted file or an
encrypted file. The former allows to securely hardcode arguments (current
manifest syntax doesn’t allow to include them inline), the latter allows the
arguments to be provided at runtime from an external (trusted) source.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pointing to an encrypted file is currently not supported, due to the fact
that encryption key provisioning currently happens after setting up
arguments.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">loader.insecure__use_cmdline_argv</span></code>, <code class="docutils literal notranslate"><span class="pre">loader.argv</span></code>, and
<code class="docutils literal notranslate"><span class="pre">loader.argv_src_file</span></code> options are mutually exclusive.</p>
<p>If none of the above arguments-handling manifest options is specified in the
manifest, the application will get <code class="docutils literal notranslate"><span class="pre">argv</span> <span class="pre">=</span> <span class="pre">[</span> <span class="pre">&lt;libos.entrypoint</span> <span class="pre">value&gt;</span> <span class="pre">]</span></code>.</p>
</section>
<section id="environment-variables">
<h3>Environment variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>loader.insecure__use_host_env = [true|false]
</pre></div>
</div>
<p>By default, environment variables from the host will <em>not</em> be passed to the app.
This can be overridden by the option above, but most applications and runtime
libraries trust their environment variables and are completely insecure when
these are attacker-controlled. For example, an attacker can execute an
additional dynamic library by specifying <code class="docutils literal notranslate"><span class="pre">LD_PRELOAD</span></code> variable.</p>
<p>To securely set up the execution environment for an app you should use one or
both of the following options:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>loader.env.[ENVIRON] = &quot;[VALUE]&quot;
or
loader.env.[ENVIRON] = { value = &quot;[VALUE]&quot; }
or
loader.env.[ENVIRON] = { passthrough = true }

loader.env_src_file = &quot;file:file_with_serialized_envs&quot;
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">loader.env.[ENVIRON]</span></code> adds/overwrites/passes a single environment variable
and can be used multiple times to specify more than one variable. To
add/overwrite the environment variable, specify a TOML string (<code class="docutils literal notranslate"><span class="pre">&quot;[VALUE]&quot;</span></code>) or
a TOML table with the key-value pair <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">value</span> <span class="pre">=</span> <span class="pre">&quot;[VALUE]&quot;</span> <span class="pre">}</span></code>. To pass the
environment variable from the host, specify a TOML table with the key-value pair
<code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">passthrough</span> <span class="pre">=</span> <span class="pre">true</span> <span class="pre">}</span></code>. If you specify a variable, it needs to either have a
value or be a passthrough.</p>
<p><code class="docutils literal notranslate"><span class="pre">loader.env_src_file</span></code> allows to specify a URI to a file containing serialized
environment, which can be generated using
<a class="reference internal" href="manpages/gramine-argv-serializer.html#gramine-argv-serializer"><span class="std std-ref">gramine-argv-serializer</span></a>. This option is intended
to point to either a trusted file or an encrypted file. The former allows to
securely hardcode environments (in a more flexible way than
<code class="docutils literal notranslate"><span class="pre">loader.env.[ENVIRON]</span></code> option), the latter allows the environments to be
provided at runtime from an external (trusted) source.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pointing to an encrypted file is currently not supported, due to the fact
that encryption key provisioning currently happens after setting up
environment variables.</p>
</div>
<p>If the same variable is set in both, then <code class="docutils literal notranslate"><span class="pre">loader.env.[ENVIRON]</span></code> takes
precedence. It is prohibited to specify both <code class="docutils literal notranslate"><span class="pre">value</span></code> and <code class="docutils literal notranslate"><span class="pre">passthrough</span></code> keys
for the same environment variable. If manifest option <code class="docutils literal notranslate"><span class="pre">insecure__use_host_env</span></code>
is specified, then <code class="docutils literal notranslate"><span class="pre">passthrough</span> <span class="pre">=</span> <span class="pre">true</span></code> manifest options have no effect (they
are “consumed” by <code class="docutils literal notranslate"><span class="pre">insecure__use_host_env</span></code>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is tempting to try to passthrough all environment variables using
<code class="docutils literal notranslate"><span class="pre">insecure__use_host_env</span></code> and then disallow some of them using <code class="docutils literal notranslate"><span class="pre">passthrough</span>
<span class="pre">=</span> <span class="pre">false</span></code>. However, this deny list approach is intentionally prohibited
because it’s inherently insecure (doesn’t provide any real security).
Gramine loudly fails if <code class="docutils literal notranslate"><span class="pre">passthrough</span> <span class="pre">=</span> <span class="pre">false</span></code> manifest options are set.</p>
</div>
</section>
<section id="user-id-and-group-id">
<h3>User ID and Group ID<a class="headerlink" href="#user-id-and-group-id" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>loader.uid = [NUM]
loader.gid = [NUM]
(Default: 0)
</pre></div>
</div>
<p>This specifies the initial, Gramine emulated user/group ID and effective
user/group ID. It must be non-negative. By default Gramine emulates the
user/group ID and effective user/group ID as the root user (uid = gid = 0).</p>
</section>
<section id="disabling-aslr">
<h3>Disabling ASLR<a class="headerlink" href="#disabling-aslr" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>loader.insecure__disable_aslr = [true|false]
(Default: false)
</pre></div>
</div>
<p>This specifies whether to disable Address Space Layout Randomization (ASLR).
Since disabling ASLR worsens security of the application, ASLR is enabled by
default.</p>
</section>
<section id="check-invalid-pointers">
<h3>Check invalid pointers<a class="headerlink" href="#check-invalid-pointers" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>libos.check_invalid_pointers = [true|false]
(Default: true)
</pre></div>
</div>
<p>This specifies whether to enable checks of invalid pointers on syscall
invocations. In particular, when this manifest option is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>,
Gramine’s LibOS will return an EFAULT error code if a user-supplied buffer
points to an invalid memory region. Setting this manifest option to <code class="docutils literal notranslate"><span class="pre">false</span></code>
may improve performance for certain workloads but may also generate
<code class="docutils literal notranslate"><span class="pre">SIGSEGV/SIGBUS</span></code> exceptions for some applications that specifically use
invalid pointers (though this is not expected for most real-world applications).</p>
</section>
<section id="gramine-internal-metadata-size">
<h3>Gramine internal metadata size<a class="headerlink" href="#gramine-internal-metadata-size" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>loader.pal_internal_mem_size = &quot;[SIZE]&quot;
(default: &quot;0&quot;)
</pre></div>
</div>
<p>This syntax specifies how much additional memory Gramine reserves for its
internal use (e.g., metadata for trusted files, internal handles,
etc.). By default, Gramine pre-allocates 64MB of internal memory for this
metadata, but for huge workloads this limit may be not enough. In this case,
Gramine loudly fails with “out of PAL memory” error. To run huge workloads,
increase this limit by setting this option to e.g. <code class="docutils literal notranslate"><span class="pre">64M</span></code> (this would result in
a total of 128MB used by Gramine for internal metadata). Note that this limit
is included in <code class="docutils literal notranslate"><span class="pre">sgx.enclave_size</span></code>, so if your enclave size is e.g. 512MB and
you specify <code class="docutils literal notranslate"><span class="pre">loader.pal_internal_mem_size</span> <span class="pre">=</span> <span class="pre">&quot;64M&quot;</span></code>, then your application is
left with 384MB of usable memory.</p>
</section>
<section id="stack-size">
<h3>Stack size<a class="headerlink" href="#stack-size" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sys.stack.size = &quot;[SIZE]&quot;
(default: &quot;256K&quot;)
</pre></div>
</div>
<p>This specifies the stack size of each thread in each Gramine process. The
default value is determined by the library OS. Units like <code class="docutils literal notranslate"><span class="pre">K</span></code> (KiB),
<code class="docutils literal notranslate"><span class="pre">M</span></code> (MiB), and <code class="docutils literal notranslate"><span class="pre">G</span></code> (GiB) can be appended to the values for
convenience. For example, <code class="docutils literal notranslate"><span class="pre">sys.stack.size</span> <span class="pre">=</span> <span class="pre">&quot;1M&quot;</span></code> indicates a 1 MiB stack
size.</p>
</section>
<section id="program-break-brk-size">
<h3>Program break (brk) size<a class="headerlink" href="#program-break-brk-size" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sys.brk.max_size = &quot;[SIZE]&quot;
(default: &quot;256K&quot;)
</pre></div>
</div>
<p>This specifies the maximal program break (brk) size in each Gramine process.
The default value of the program break size is determined by the library OS.
Units like <code class="docutils literal notranslate"><span class="pre">K</span></code> (KiB), <code class="docutils literal notranslate"><span class="pre">M</span></code> (MiB), and <code class="docutils literal notranslate"><span class="pre">G</span></code> (GiB) can be appended to the
values for convenience. For example, <code class="docutils literal notranslate"><span class="pre">sys.brk.max_size</span> <span class="pre">=</span> <span class="pre">&quot;1M&quot;</span></code> indicates
a 1 MiB brk size.</p>
</section>
<section id="allowing-eventfd">
<h3>Allowing eventfd<a class="headerlink" href="#allowing-eventfd" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sys.insecure__allow_eventfd = [true|false]
(Default: false)
</pre></div>
</div>
<p>This specifies whether to allow system calls <cite>eventfd()</cite> and <cite>eventfd2()</cite>. Since
eventfd emulation currently relies on the host, these system calls are
disallowed by default due to security concerns.</p>
</section>
<section id="external-sigterm-injection">
<h3>External SIGTERM injection<a class="headerlink" href="#external-sigterm-injection" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sys.enable_sigterm_injection = [true|false]
(Default: false)
</pre></div>
</div>
<p>This specifies whether to allow for a one-time injection of <cite>SIGTERM</cite> signal
into Gramine. Could be useful to handle graceful shutdown.
Be careful! In SGX environment, the untrusted host could inject that signal in
an arbitrary moment. Examine what your application’s <cite>SIGTERM</cite> handler does and
whether it poses any security threat.</p>
</section>
<section id="root-fs-mount-point">
<h3>Root FS mount point<a class="headerlink" href="#root-fs-mount-point" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fs.root.type = &quot;[chroot|...]&quot;
fs.root.uri  = &quot;[URI]&quot;
</pre></div>
</div>
<p>This syntax specifies the root file system to be mounted inside the library OS.
Both parameters are optional. If not specified, then Gramine mounts the current
working directory as the root.</p>
</section>
<section id="fs-mount-points">
<h3>FS mount points<a class="headerlink" href="#fs-mount-points" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fs.mounts = [
  { type = &quot;[chroot|...]&quot;, path = &quot;[PATH]&quot;, uri = &quot;[URI]&quot; },
  { type = &quot;[chroot|...]&quot;, path = &quot;[PATH]&quot;, uri = &quot;[URI]&quot; },
]
</pre></div>
</div>
<p>Or, as separate sections:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[[fs.mounts]]
type = &quot;[chroot|...]&quot;
path = &quot;[PATH]&quot;
uri  = &quot;[URI]&quot;

[[fs.mounts]]
type = &quot;[chroot|...]&quot;
path = &quot;[PATH]&quot;
uri  = &quot;[URI]&quot;
</pre></div>
</div>
<p>This syntax specifies how file systems are mounted inside the library OS. For
dynamically linked binaries, usually at least one <cite>chroot</cite> mount point is
required in the manifest (the mount point of linked libraries). The filesystems
will be mounted in the order in which they appear in the manifest.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Keep in mind that TOML does not allow trailing commas in inline tables:
<code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">path</span> <span class="pre">=</span> <span class="pre">&quot;...&quot;,</span> <span class="pre">uri</span> <span class="pre">=</span> <span class="pre">&quot;...&quot;,</span> <span class="pre">}</span></code> is a syntax error.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type</span></code> parameter specifies the mount point type. If omitted, it defaults
to <code class="docutils literal notranslate"><span class="pre">&quot;chroot&quot;</span></code>. The <code class="docutils literal notranslate"><span class="pre">path</span></code> parameter must be an absolute path (i.e. must
begin with <code class="docutils literal notranslate"><span class="pre">/</span></code>).</p>
<p>Gramine currently supports the following types of mount points:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">chroot</span></code> (default): Host-backed files. All host files and sub-directories
found under <code class="docutils literal notranslate"><span class="pre">[URI]</span></code> are forwarded to the Gramine instance and placed under
<code class="docutils literal notranslate"><span class="pre">[PATH]</span></code>. For example, with a host-level path specified as <code class="docutils literal notranslate"><span class="pre">uri</span> <span class="pre">=</span>
<span class="pre">&quot;file:/one/path/&quot;</span></code> and forwarded to Gramine via <code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">=</span> <span class="pre">&quot;/another/path&quot;</span></code>, a
host-level file <code class="docutils literal notranslate"><span class="pre">/one/path/file</span></code> is visible to graminized application as
<code class="docutils literal notranslate"><span class="pre">/another/path/file</span></code>. This concept is similar to FreeBSD’s chroot and to
Docker’s named volumes. Files under <code class="docutils literal notranslate"><span class="pre">chroot</span></code> mount points support mmap and
fork/clone.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">encrypted</span></code>: Host-backed encrypted files. See <a class="reference internal" href="#encrypted-files"><span class="std std-ref">Encrypted files</span></a> for
more information.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tmpfs</span></code>: Temporary in-memory-only files. These files are <em>not</em> backed by
host-level files. The tmpfs files are created under <code class="docutils literal notranslate"><span class="pre">[PATH]</span></code> (this path is
empty on Gramine instance startup) and are destroyed when a Gramine instance
terminates. The <code class="docutils literal notranslate"><span class="pre">[URI]</span></code> parameter is always ignored, and can be omitted.</p>
<p><code class="docutils literal notranslate"><span class="pre">tmpfs</span></code> is especially useful in trusted environments (like Intel SGX) for
securely storing temporary files. This concept is similar to Linux’s tmpfs.
Files under <code class="docutils literal notranslate"><span class="pre">tmpfs</span></code> mount points currently do <em>not</em> support mmap and each
process has its own, non-shared tmpfs (i.e. processes don’t see each other’s
files).</p>
</li>
</ul>
</section>
<section id="start-current-working-directory">
<h3>Start (current working) directory<a class="headerlink" href="#start-current-working-directory" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fs.start_dir = &quot;[URI]&quot;
</pre></div>
</div>
<p>This syntax specifies the start (current working) directory. If not specified,
then Gramine sets the root directory as the start directory (see <code class="docutils literal notranslate"><span class="pre">fs.root</span></code>).</p>
</section>
</section>
<section id="sgx-syntax">
<h2>SGX syntax<a class="headerlink" href="#sgx-syntax" title="Permalink to this headline"></a></h2>
<p>If Gramine is <em>not</em> running with SGX, the SGX-specific syntax is ignored. All
keys in the SGX-specific syntax are optional.</p>
<section id="debug-production-enclave">
<h3>Debug/production enclave<a class="headerlink" href="#debug-production-enclave" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.debug = [true|false]
(Default: false)
</pre></div>
</div>
<p>This syntax specifies whether the enclave can be debugged. Set it to <code class="docutils literal notranslate"><span class="pre">true</span></code>
for a debug enclave and to <code class="docutils literal notranslate"><span class="pre">false</span></code> for a production enclave.</p>
</section>
<section id="enclave-size">
<h3>Enclave size<a class="headerlink" href="#enclave-size" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.enclave_size = &quot;[SIZE]&quot;
(default: &quot;256M&quot;)
</pre></div>
</div>
<p>This syntax specifies the size of the enclave set during enclave creation time
(recall that SGX v1 requires a predetermined maximum size of the enclave).
The PAL and library OS code/data count towards this size value, as well as the
application memory itself: application’s code, stack, heap, loaded application
libraries, etc. The application cannot allocate memory that exceeds this limit.</p>
<p>Be careful when setting the enclave size to large values: on systems where the
<a class="reference internal" href="sgx-intro.html#term-EDMM"><span class="xref std std-term">EDMM</span></a> feature is not enabled, Gramine not only reserves
<code class="docutils literal notranslate"><span class="pre">sgx.enclave_size</span></code> bytes of virtual address space but also <em>commits</em> them to
the backing store (EPC, RAM and/or swap file). For example, if
<code class="docutils literal notranslate"><span class="pre">sgx.enclave_size</span> <span class="pre">=</span> <span class="pre">&quot;4G&quot;</span></code>, then 4GB of EPC/RAM will be immediately allocated
to back the enclave memory (recall that <a class="reference internal" href="sgx-intro.html#term-EPC"><span class="xref std std-term">EPC</span></a> is the SGX-protected part of
RAM). Thus, if your system has 4GB of backing store or less, then the host Linux
kernel will fail to start the SGX enclave and will typically print the
<code class="docutils literal notranslate"><span class="pre">Killed</span></code> message. If you encounter this situation, you can try the following:</p>
<ul class="simple">
<li><p>If possible, decrease <code class="docutils literal notranslate"><span class="pre">sgx.enclave_size</span></code> to a value less than the amount of
RAM. For example, if you have 4GB of RAM, set <code class="docutils literal notranslate"><span class="pre">sgx.enclave_size</span> <span class="pre">=</span> <span class="pre">&quot;2G&quot;</span></code>.</p></li>
<li><p>Switch to a system that has more RAM. For example, if you must use
<code class="docutils literal notranslate"><span class="pre">sgx.enclave_size</span> <span class="pre">=</span> <span class="pre">&quot;4G&quot;</span></code>, move to a system with at least 5GB of RAM.</p></li>
<li><p>If the above options are ruled out, then increase the swap file size (recall
that the swap file is a space on hard disk used as a virtual “extension” to
real RAM). For example, if you have 4GB of RAM and you must use
<code class="docutils literal notranslate"><span class="pre">sgx.enclave_size</span> <span class="pre">=</span> <span class="pre">&quot;4G&quot;</span></code>, then create the swap file of size 1GB. Note that
as soon as the SGX application starts using the swap file, its performance
degrades significantly!</p></li>
</ul>
<p>Also, be careful with multi-process SGX applications: each new child process
runs in its own SGX enclave and thus requires an additional <code class="docutils literal notranslate"><span class="pre">sgx.enclave_size</span></code>
amount of RAM. For example, if you run <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">-c</span> <span class="pre">ls</span></code> and your manifest contains
<code class="docutils literal notranslate"><span class="pre">sgx.enclave_size</span> <span class="pre">=</span> <span class="pre">&quot;4G&quot;</span></code>, then two SGX enclaves (bash and ls processes) will
consume 8GB of RAM in total. If there is less than 8GB of RAM (+ swap file) on
your system, such <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">-c</span> <span class="pre">ls</span></code> SGX workload will fail.</p>
</section>
<section id="non-pie-binaries">
<h3>Non-PIE binaries<a class="headerlink" href="#non-pie-binaries" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.nonpie_binary = [true|false]
(Default: false)
</pre></div>
</div>
<p>This setting tells Gramine whether to use a specially crafted memory layout,
which is required to support non-relocatable binaries (non-PIE).</p>
</section>
<section id="number-of-threads">
<h3>Number of threads<a class="headerlink" href="#number-of-threads" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.thread_num = [NUM]
(Default: 4)
</pre></div>
</div>
<p>This syntax specifies the maximum number of threads that can be created inside
the enclave (recall that SGX v1 requires a predetermined maximum number
of thread slots). The application cannot have more threads than this limit <em>at
a time</em> (however, it is possible to create new threads after old threads are
destroyed).</p>
<p>Note that Gramine uses several helper threads internally:</p>
<ul class="simple">
<li><p>The IPC thread to facilitate inter-process communication. This thread is
always spawned at Gramine startup. Its activity depends on the communication
patterns among Gramine processes; if there is only one Gramine process, the
IPC thread always sleeps.</p></li>
<li><p>The Async thread to implement timers and other asynchronous
events/notifications. This thread is spawned on demand. It terminates itself
if there are no pending events/notifications.</p></li>
<li><p>The TLS-handshake thread on pipes creation. This thread is spawned on demand,
each time a new pipe is created. It terminates itself immediately after the
TLS handshake is performed.</p></li>
</ul>
<p>Given these internal threads, <code class="docutils literal notranslate"><span class="pre">sgx.thread_num</span></code> should be set to at least <code class="docutils literal notranslate"><span class="pre">4</span></code>
even for single-threaded applications (to accommodate for the main thread, the
IPC thread, the Async thread and one TLS-handshake thread).</p>
</section>
<section id="number-of-rpc-threads-exitless-feature">
<h3>Number of RPC threads (Exitless feature)<a class="headerlink" href="#number-of-rpc-threads-exitless-feature" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.rpc_thread_num = [NUM]
(Default: 0)
</pre></div>
</div>
<p>This syntax specifies the number of RPC threads that are created outside of
the enclave. RPC threads are helper threads that run in untrusted mode
alongside enclave threads. RPC threads issue system calls on behalf of enclave
threads. This allows “exitless” design when application threads never leave
the enclave (except for a few syscalls where there is no benefit, e.g.,
<code class="docutils literal notranslate"><span class="pre">nanosleep()</span></code>).</p>
<p>If user specifies <code class="docutils literal notranslate"><span class="pre">0</span></code> or omits this directive, then no RPC threads are
created and all system calls perform an enclave exit (“normal” execution).</p>
<p>Note that the number of created RPC threads must match the maximum number of
simultaneous enclave threads. If there are more RPC threads, then CPU time is
wasted. If there are less RPC threads, some enclave threads may starve,
especially if there are many blocking system calls by other enclave threads.</p>
<p>The Exitless feature <em>may be detrimental for performance</em>. It trades slow
OCALLs/ECALLs for fast shared-memory communication at the cost of occupying
more CPU cores and burning more CPU cycles. For example, a single-threaded
Redis instance on Linux becomes 5-threaded on Gramine with Exitless. Thus,
Exitless may negatively impact throughput but may improve latency.</p>
</section>
<section id="optional-cpu-features-avx-avx512-mpx-pkru-amx">
<h3>Optional CPU features (AVX, AVX512, MPX, PKRU, AMX)<a class="headerlink" href="#optional-cpu-features-avx-avx512-mpx-pkru-amx" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.require_avx    = [true|false]
sgx.require_avx512 = [true|false]
sgx.require_mpx    = [true|false]
sgx.require_pkru   = [true|false]
sgx.require_amx    = [true|false]
(Default: false)
</pre></div>
</div>
<p>This syntax ensures that the CPU features are available and enabled for the
enclave. If the options are set in the manifest but the features are unavailable
on the platform, enclave initialization will fail. If the options are unset,
enclave initialization will succeed even if these features are unavailable on
the platform.</p>
</section>
<section id="isv-product-id-and-svn">
<h3>ISV Product ID and SVN<a class="headerlink" href="#isv-product-id-and-svn" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.isvprodid = [NUM]
sgx.isvsvn    = [NUM]
(Default: 0)
</pre></div>
</div>
<p>This syntax specifies the ISV Product ID and SVN to be added to the enclave
signature.</p>
</section>
<section id="attribute-masks-for-sgx-sealing-key-derivation">
<h3>Attribute masks for SGX sealing key derivation<a class="headerlink" href="#attribute-masks-for-sgx-sealing-key-derivation" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.seal_key.flags_mask = &quot;[8-byte hex value]&quot;  (default: &quot;0xffffffffffffffff&quot;)
sgx.seal_key.xfrm_mask  = &quot;[8-byte hex value]&quot;  (default: &quot;0xfffffffffff9ff1b&quot;)
sgx.seal_key.misc_mask  = &quot;[4-byte hex value]&quot;  (default: &quot;0xffffffff&quot;)
</pre></div>
</div>
<p>This syntax specifies masks used to generate the SGX sealing key. These masks
correspond to the following SGX <code class="docutils literal notranslate"><span class="pre">KEYREQUEST</span></code> struct fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">flags_mask</span></code>: <code class="docutils literal notranslate"><span class="pre">KEYREQUEST.ATTRIBUTESMASK.FLAGS</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xfrm_mask</span></code>: <code class="docutils literal notranslate"><span class="pre">KEYREQUEST.ATTRIBUTESMASK.XFRM</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">misc_mask</span></code>: <code class="docutils literal notranslate"><span class="pre">KEYREQUEST.MISCMASK</span></code></p></li>
</ul>
<p>Most users do <em>not</em> need to set these masks. Only advanced users with knowledge
of SGX sealing should use these masks. In particular, these masks allow to
specify a subset of enclave/machine attributes to be used in sealing key
derivation. Moreover, these masks themselves are used in sealing key derivation.</p>
</section>
<section id="allowed-files">
<h3>Allowed files<a class="headerlink" href="#allowed-files" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.allowed_files = [
  &quot;[URI]&quot;,
  &quot;[URI]&quot;,
]
</pre></div>
</div>
<p>This syntax specifies the files that are allowed to be created or loaded into
the enclave unconditionally. In other words, allowed files can be opened for
reading/writing and can be created if they do not exist already. Allowed files
are not cryptographically hashed and are thus not protected.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is insecure to allow files containing code or critical information;
developers must not allow files blindly! Instead, use trusted or encrypted
files.</p>
</div>
</section>
<section id="trusted-files">
<h3>Trusted files<a class="headerlink" href="#trusted-files" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># entries can be strings
sgx.trusted_files = [
  &quot;[URI]&quot;,
  &quot;[URI]&quot;,
]

# entries can also be tables
[[sgx.trusted_files]]
uri = &quot;[URI]&quot;
sha256 = &quot;[HASH]&quot;
</pre></div>
</div>
<p>This syntax specifies the files to be cryptographically hashed at build time,
and allowed to be accessed by the app in runtime only if their hashes match.
This implies that trusted files can be only opened for reading (not for writing)
and cannot be created if they do not exist already. The signer tool will
automatically generate hashes of these files and add them to the SGX-specific
manifest (<code class="docutils literal notranslate"><span class="pre">.manifest.sgx</span></code>). The manifest writer may also specify the hash for
a file using the TOML-table syntax, in the field <code class="docutils literal notranslate"><span class="pre">sha256</span></code>; in this case,
hashing of the file will be skipped by the signer tool and the value in
<code class="docutils literal notranslate"><span class="pre">sha256</span></code> field will be used instead.</p>
<p>Marking files as trusted is especially useful for shared libraries: a trusted library cannot be silently replaced by a malicious host because the hash
verification will fail.</p>
</section>
<section id="encrypted-files">
<span id="id1"></span><h3>Encrypted files<a class="headerlink" href="#encrypted-files" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fs.mounts = [
  { type = &quot;encrypted&quot;, path = &quot;[PATH]&quot;, uri = &quot;[URI]&quot;, key_name = &quot;[KEY_NAME]&quot; },
]

fs.insecure__keys.[KEY_NAME] = &quot;[32-character hex value]&quot;
</pre></div>
</div>
<p>This syntax allows mounting files that are encrypted on disk and transparently
decrypted when accessed by Gramine or by application running inside Gramine.
Encrypted files guarantee data confidentiality and integrity (tamper
resistance), as well as file swap protection (an encrypted file can only be
accessed when in a specific host path).</p>
<p>Encrypted files were previously known as <em>protected files</em>, and some Gramine
tools might still use the old name.</p>
<p>URI can be a file or a directory. If a directory is mounted, all existing
files/directories within it are recursively treated as encrypted (and are
expected to be encrypted in the PF format). New files created in an encrypted
mount are also automatically treated as encrypted.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The current implementation assumes that <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">&quot;encrypted&quot;</span></code> mounts do not
overlap on host, i.e. there are no host files reachable through more than one
<code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">&quot;encrypted&quot;</span></code> mount. Otherwise, changes made to such files might not
be correctly persisted by Gramine.</p>
</div>
<p>Note that path size of an encrypted file is limited to 512 bytes and filename
size is limited to 260 bytes.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">key_name</span></code> mount parameter specifies the name of the encryption key. If
omitted, it will default to <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code>. This feature can be used to mount
different files or directories with different encryption keys.</p>
<p><code class="docutils literal notranslate"><span class="pre">fs.insecure__keys.[KEY_NAME]</span></code> can be used to specify the encryption keys
directly in manifest. This option must be used only for debugging purposes.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">sgx.insecure__keys.[KEY_NAME]</span></code> hard-codes the key in the manifest. This
option is thus insecure and must not be used in production environments!
Typically, you want to provision the encryption keys using SGX
local/remote attestation, thus you should not specify any
<code class="docutils literal notranslate"><span class="pre">sgx.insecure__keys.[KEY_NAME]</span></code> manifest options at all. Instead, use the
Secret Provisioning interface (see <a class="reference internal" href="attestation.html"><span class="doc">Attestation and Secret Provisioning</span></a>).</p>
</div>
<p>Key names beginning with underscore (<code class="docutils literal notranslate"><span class="pre">_</span></code>) denote special keys provided by
Gramine:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;_sgx_mrenclave&quot;</span></code> (SGX only) is the SGX sealing key based on the MRENCLAVE
identity of the enclave. This is useful to allow only the same enclave (on the
same platform) to unseal files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;_sgx_mrsigner&quot;</span></code> (SGX only) is the SGX sealing key based on the MRSIGNER
identity of the enclave. This is useful to allow all enclaves signed with the
same key (and on the same platform) to unseal files.</p></li>
</ul>
</section>
<section id="file-check-policy">
<h3>File check policy<a class="headerlink" href="#file-check-policy" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.file_check_policy = &quot;[strict|allow_all_but_log]&quot;
(Default: &quot;strict&quot;)
</pre></div>
</div>
<p>This syntax specifies the file check policy, determining the behavior of
authentication when opening files. By default, only files explicitly listed as
<code class="docutils literal notranslate"><span class="pre">trusted_files</span></code> or <code class="docutils literal notranslate"><span class="pre">allowed_files</span></code> declared in the manifest are allowed for
access.</p>
<p>If the file check policy is <code class="docutils literal notranslate"><span class="pre">allow_all_but_log</span></code>, all files other than trusted
and allowed are allowed for access, and Gramine emits a warning message for
every such file. Effectively, this policy operates on all unknown files as if
they were listed as <code class="docutils literal notranslate"><span class="pre">allowed_files</span></code>. (However, this policy still does not
allow writing/creating files specified as trusted.) This policy is a convenient
way to determine the set of files that the ported application uses.</p>
</section>
<section id="attestation-and-quotes">
<h3>Attestation and quotes<a class="headerlink" href="#attestation-and-quotes" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.remote_attestation = &quot;[none|epid|dcap]&quot;
(Default: &quot;none&quot;)

sgx.ra_client_linkable = [true|false]
sgx.ra_client_spid     = &quot;[HEX]&quot;
(Only for EPID based attestation)
</pre></div>
</div>
<p>This syntax specifies the parameters for remote attestation. By default it is
not enabled.</p>
<p>For <a class="reference internal" href="sgx-intro.html#term-EPID"><span class="xref std std-term">EPID</span></a> based attestation, <code class="docutils literal notranslate"><span class="pre">remote_attestation</span></code> must be set to
<code class="docutils literal notranslate"><span class="pre">epid</span></code>.  In addition, <code class="docutils literal notranslate"><span class="pre">ra_client_linkable</span></code> and <code class="docutils literal notranslate"><span class="pre">ra_client_spid</span></code> must be
filled with your registered Intel SGX EPID Attestation Service credentials
(linkable/unlinkable mode and <a class="reference internal" href="sgx-intro.html#term-SPID"><span class="xref std std-term">SPID</span></a> of the client respectively).</p>
<p>For <a class="reference internal" href="sgx-intro.html#term-DCAP"><span class="xref std std-term">DCAP</span></a> based attestation, <code class="docutils literal notranslate"><span class="pre">remote_attestation</span></code> must be set to
<code class="docutils literal notranslate"><span class="pre">dcap</span></code>. <code class="docutils literal notranslate"><span class="pre">ra_client_spid</span></code> and <code class="docutils literal notranslate"><span class="pre">ra_client_linkable</span></code> are ignored.</p>
</section>
<section id="pre-heating-enclave">
<h3>Pre-heating enclave<a class="headerlink" href="#pre-heating-enclave" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.preheat_enclave = [true|false]
(Default: false)
</pre></div>
</div>
<p>When enabled, this option instructs Gramine to pre-fault all heap pages during
initialization. This has a negative impact on the total run time, but shifts the
<a class="reference internal" href="sgx-intro.html#term-EPC"><span class="xref std std-term">EPC</span></a> page faults cost to the initialization phase, which can be useful in
a scenario where a server starts and receives connections / work packages only
after some time. It also makes the later run time and latency much more
predictable.</p>
<p>Please note that using this option makes sense only when the <a class="reference internal" href="sgx-intro.html#term-EPC"><span class="xref std std-term">EPC</span></a> is
large enough to hold the whole heap area.</p>
</section>
<section id="enabling-per-thread-and-process-wide-sgx-stats">
<h3>Enabling per-thread and process-wide SGX stats<a class="headerlink" href="#enabling-per-thread-and-process-wide-sgx-stats" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.enable_stats = [true|false]
(Default: false)
</pre></div>
</div>
<p>This syntax specifies whether to enable SGX enclave-specific statistics:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TCS.FLAGS.DBGOPTIN</span></code> flag. This flag is set in all enclave threads and
enables certain debug and profiling features with enclaves, including
breakpoints, performance counters, Intel PT, etc.</p></li>
<li><p>Printing the stats on SGX-specific events. Currently supported stats are:
number of EENTERs (corresponds to ECALLs plus returns from OCALLs), number
of EEXITs (corresponds to OCALLs plus returns from ECALLs) and number of
AEXs (corresponds to interrupts/exceptions/signals during enclave
execution). Prints per-thread and per-process stats.</p></li>
<li><p>Printing the SGX enclave loading time at startup. The enclave loading time
includes creating the enclave, adding enclave pages, measuring them and
initializing the enclave.</p></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This option is insecure and cannot be used with production enclaves
(<code class="docutils literal notranslate"><span class="pre">sgx.debug</span> <span class="pre">=</span> <span class="pre">false</span></code>). If a production enclave is started with this option
set, Gramine will fail initialization of the enclave.</p>
</div>
</section>
<section id="sgx-profiling">
<h3>SGX profiling<a class="headerlink" href="#sgx-profiling" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.profile.enable = [&quot;none&quot;|&quot;main&quot;|&quot;all&quot;]
(Default: &quot;none&quot;)
</pre></div>
</div>
<p>This syntax specifies whether to enable SGX profiling. Gramine must be compiled
with <code class="docutils literal notranslate"><span class="pre">DEBUG=1</span></code> or <code class="docutils literal notranslate"><span class="pre">DEBUGOPT=1</span></code> for this option to work (the latter is
advised).</p>
<p>If this option is set to <code class="docutils literal notranslate"><span class="pre">main</span></code>, the main process will collect IP samples and
save them as <code class="docutils literal notranslate"><span class="pre">sgx-perf.data</span></code>. If it is set to <code class="docutils literal notranslate"><span class="pre">all</span></code>, all processes will
collect samples and save them to <code class="docutils literal notranslate"><span class="pre">sgx-perf-&lt;PID&gt;.data</span></code>.</p>
<p>The saved files can be viewed with the <code class="docutils literal notranslate"><span class="pre">perf</span></code> tool, e.g. <code class="docutils literal notranslate"><span class="pre">perf</span> <span class="pre">report</span> <span class="pre">-i</span>
<span class="pre">sgx-perf.data</span></code>.</p>
<p>See <a class="reference internal" href="performance.html#sgx-profile"><span class="std std-ref">SGX profiling</span></a> for more information.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This option is insecure and cannot be used with production enclaves
(<code class="docutils literal notranslate"><span class="pre">sgx.debug</span> <span class="pre">=</span> <span class="pre">false</span></code>). If a production enclave is started with this option
set, Gramine will fail initialization of the enclave.</p>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.profile.mode = [&quot;aex&quot;|&quot;ocall_inner&quot;|&quot;ocall_outer&quot;]
(Default: &quot;aex&quot;)
</pre></div>
</div>
<p>Specifies what events to record:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aex</span></code>: Records enclave state during asynchronous enclave exit (AEX). Use
this to check where the CPU time is spent in the enclave.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ocall_inner</span></code>: Records enclave state during OCALL.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ocall_outer</span></code>: Records the outer OCALL function, i.e. what OCALL handlers
are going to be executed. Does not include stack information (cannot be used
with <code class="docutils literal notranslate"><span class="pre">sgx.profile.with_stack</span> <span class="pre">=</span> <span class="pre">true</span></code>).</p></li>
</ul>
<p>See also <a class="reference internal" href="performance.html#sgx-profile-ocall"><span class="std std-ref">OCALL profiling</span></a> for more detailed advice regarding the OCALL
modes.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.profile.with_stack = [true|false]
(Default: false)
</pre></div>
</div>
<p>This syntax specifies whether to include stack information with the profiling
data. This will enable <code class="docutils literal notranslate"><span class="pre">perf</span> <span class="pre">report</span></code> to show call chains. However, it will
make the output file much bigger, and slow down the process.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.profile.frequency = [INTEGER]
(Default: 50)
</pre></div>
</div>
<p>This syntax specifies approximate frequency at which profiling samples are taken
(in samples per second). Lower values will mean less accurate results, but also
lower overhead.</p>
<p>Note that the accuracy is limited by how often the process is interrupted by
Linux scheduler: the effective maximum is 250 samples per second.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This option applies only to <code class="docutils literal notranslate"><span class="pre">aex</span></code> mode. In the <code class="docutils literal notranslate"><span class="pre">ocall_*</span></code> modes, currently
all samples are taken.</p>
</div>
</section>
<section id="sgx-profiling-with-intel-vtune-profiler">
<h3>SGX profiling with Intel VTune Profiler<a class="headerlink" href="#sgx-profiling-with-intel-vtune-profiler" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.vtune_profile = [true|false]
(Default: false)
</pre></div>
</div>
<p>This syntax specifies whether to enable SGX profiling with Intel VTune Profiler.
Gramine must be compiled with <code class="docutils literal notranslate"><span class="pre">DEBUG=1</span></code> or <code class="docutils literal notranslate"><span class="pre">DEBUGOPT=1</span></code> for this option to
work (the latter is advised). In addition, the application manifest must also
contain <code class="docutils literal notranslate"><span class="pre">sgx.debug</span> <span class="pre">=</span> <span class="pre">true</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The manifest options <code class="docutils literal notranslate"><span class="pre">sgx.vtune_profile</span></code> and <code class="docutils literal notranslate"><span class="pre">sgx.profile.*</span></code> can work
independently.</p>
</div>
<p>See <a class="reference internal" href="performance.html#vtune-sgx-profiling"><span class="std std-ref">Profiling SGX hotspots with Intel VTune Profiler</span></a> for more information.</p>
</section>
</section>
<section id="deprecated-options">
<h2>Deprecated options<a class="headerlink" href="#deprecated-options" title="Permalink to this headline"></a></h2>
<section id="fs-mount-points-deprecated-syntax">
<h3>FS mount points (deprecated syntax)<a class="headerlink" href="#fs-mount-points-deprecated-syntax" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fs.mount.[identifier].type = &quot;[chroot|...]&quot;
fs.mount.[identifier].path = &quot;[PATH]&quot;
fs.mount.[identifier].uri  = &quot;[URI]&quot;
</pre></div>
</div>
<p>This syntax used a TOML table schema with keys for each mount. It has been
replaced with the <code class="docutils literal notranslate"><span class="pre">fs.mounts</span></code> TOML array.</p>
</section>
<section id="experimental-sysfs-topology-support">
<h3>Experimental sysfs topology support<a class="headerlink" href="#experimental-sysfs-topology-support" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fs.experimental__enable_sysfs_topology = [true|false]
</pre></div>
</div>
<p>This feature is now enabled by default and the option was removed.</p>
</section>
<section id="protected-files-deprecated-syntax">
<h3>Protected files (deprecated syntax)<a class="headerlink" href="#protected-files-deprecated-syntax" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.protected_files = [
  &quot;[URI]&quot;,
  &quot;[URI]&quot;,
]

sgx.protected_mrenclave_files = [
  &quot;[URI]&quot;,
  &quot;[URI]&quot;,
]

sgx.protected_mrsigner_files = [
  &quot;[URI]&quot;,
  &quot;[URI]&quot;,
]
</pre></div>
</div>
<p>This syntax specified the previous SGX-only protected files. It has been
replaced with <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">&quot;encrypted&quot;</span></code> mounts (see <a class="reference internal" href="#encrypted-files"><span class="std std-ref">Encrypted files</span></a>).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Gramine will attempt to convert this syntax to mounted filesystems, but might
fail to do so correctly in more complicated cases (e.g. when a single host
file belongs to multiple mounts). It is recommended to rewrite all usages of
this syntax to <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">&quot;encrypted&quot;</span></code> mounts.</p>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fs.insecure__protected_files_key = &quot;[32-character hex value]&quot;
</pre></div>
</div>
<p>This syntax allowed specifying the default encryption key for protected files.
It has been replaced by <code class="docutils literal notranslate"><span class="pre">fs.insecure__keys.[KEY_NAME]]</span></code>. Note that both old
and new syntax are suitable for debugging purposes only.</p>
</section>
<section id="attestation-and-quotes-deprecated-syntax">
<h3>Attestation and quotes (deprecated syntax)<a class="headerlink" href="#attestation-and-quotes-deprecated-syntax" title="Permalink to this headline"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sgx.remote_attestation = [true|false]
</pre></div>
</div>
<p>This syntax specified whether to enable SGX remote attestation. The boolean
value has been replaced with the string value. The <code class="docutils literal notranslate"><span class="pre">none</span></code> value in the new
syntax corresponds to the <code class="docutils literal notranslate"><span class="pre">false</span></code> boolean value in the deprecated syntax. The
explicit <code class="docutils literal notranslate"><span class="pre">epid</span></code> and <code class="docutils literal notranslate"><span class="pre">dcap</span></code> values in the new syntax replace the ambiguous
<code class="docutils literal notranslate"><span class="pre">true</span></code> boolean value in the deprecated syntax.</p>
</section>
</section>
</section>


           </div>
          </div>

          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="configuration-index.html" class="btn btn-neutral float-left" title="Configure Gramine" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="attestation.html" class="btn btn-neutral float-right" title="Attestation and Secret Provisioning" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Gramine Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>